install.packages("iNEXT.3D")
library(devtools)
install_github("KaiHsiangHu/iNEXT.3D")
library(iNEXT.3D)
MAGrel <- read.csv("data/MAG_relative.csv",row.names=1)
MAGtree <- read.tree("data/MAG.tree")
cat_metadata <- read.csv("data/DomestiCAT_metadata_curated.csv")
est_neutral <- estimate3D(MAGrel, diversity = "TD", q = c(0,1,2), datatype = "abundance", base = "coverage", level = NULL, nboot = 50, conf = 0.95, nT, PDtree, PDreftime = NULL, PDtype = "meanPD", FDdistM, FDtype = "AUC", FDtau = NULL)
setwd("/Users/anttonalberdi/github/domesticat/")
MAGrel <- read.csv("data/MAG_relative.csv",row.names=1)
MAGtree <- read.tree("data/MAG.tree")
cat_metadata <- read.csv("data/DomestiCAT_metadata_curated.csv")
est_neutral <- estimate3D(MAGrel, diversity = "TD", q = c(0,1,2), datatype = "abundance", base = "coverage", level = NULL, nboot = 50, conf = 0.95, nT, PDtree, PDreftime = NULL, PDtype = "meanPD", FDdistM, FDtype = "AUC", FDtau = NULL)
library(ape)
library(iNEXT.3D)
MAGrel <- read.csv("data/MAG_relative.csv",row.names=1)
MAGtree <- read.tree("data/MAG.tree")
cat_metadata <- read.csv("data/DomestiCAT_metadata_curated.csv")
est_neutral <- estimate3D(MAGrel, diversity = "TD", q = c(0,1,2), datatype = "abundance", base = "coverage", level = NULL, nboot = 50, conf = 0.95, nT, PDtree, PDreftime = NULL, PDtype = "meanPD", FDdistM, FDtype = "AUC", FDtau = NULL)
head(MAGrel)
MAGtree <- read.tree("data/MAG.tree")
MAGinfo <- read.csv("data/MAG_info.csv")
MAGannot <- read.delim("data/DRAM_product.tsv",sep='\t')
head(MAGannot)
MAGannot <- read.delim("data/DRAM_product.tsv",sep='\t', row.names=1)
head(MAGannot)
head(MAGinfo)
MAGinfo <- read.csv("data/MAG_info.csv", row.names=1)
head(MAGinfo)
MAGannot <- MAGannot[rownames(MAGinfo),]
head(MAGannot)
colnames(MAGannot[,colSums(MAGannot)==0])
# Convert True/False character to 1/0 binary, numeric data
for(i in 1:ncol(MAGannot)){
if(is.character(MAGannot[,i])){
MAGannot[,i][MAGannot[,i]=="True"]=1
MAGannot[,i][MAGannot[,i]=="False"]=0
MAGannot[,i]=as.numeric(MAGannot[,i])
}
}
colnames(MAGannot[,colSums(MAGannot)==0])
MAGannot <- MAGannot[,colSums(MAGannot)>0]
head(MAGinfo)
phylumcolors <- c("#5b828e","#5e6668","#bbcfd7","#ba9a88","#ac7e62","#aca69f","#adab76","#666b3a","#0f211a","#012e67")
ggplot(MAGinfo,aes(y=Completeness,x=Contamination,fill=Phylum, color=Phylum)) +
geom_point() +
theme_classic()
library(ggplot2)
phylumcolors <- c("#5b828e","#5e6668","#bbcfd7","#ba9a88","#ac7e62","#aca69f","#adab76","#666b3a","#0f211a","#012e67")
ggplot(MAGinfo,aes(y=Completeness,x=Contamination,fill=Phylum, color=Phylum)) +
geom_point() +
theme_classic()
ggplot(MAGinfo,aes(y=Contamination,x=Completeness,fill=Phylum, color=Phylum)) +
geom_point() +
scale_fill_manual(values=phylumcolors)
theme_classic()
ggplot(MAGinfo,aes(y=Contamination,x=Completeness,fill=Phylum, color=Phylum)) +
geom_point() +
scale_color_manual(values=phylumcolors)
theme_classic()
ggplot(MAGinfo,aes(y=Contamination,x=Completeness,fill=Phylum, color=Phylum)) +
geom_point() +
scale_color_manual(values=phylumcolors) +
theme_classic()
pdf("figures/MAG_comp-cont.pdf",width=8,height=6)
ggplot(MAGinfo,aes(y=Contamination,x=Completeness,fill=Phylum, color=Phylum)) +
geom_point() +
scale_color_manual(values=phylumcolors) +
theme_classic()
dev.off()
pdf("figures/MAG_comp-cont.pdf",width=8,height=4)
ggplot(MAGinfo,aes(y=Contamination,x=Completeness,fill=Phylum, color=Phylum)) +
geom_point() +
scale_color_manual(values=phylumcolors) +
theme_classic()
dev.off()
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_bar() +
scale_fill_manual(values=phylumcolors) +
theme_classic()
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_bar(stat = "identity") +
scale_fill_manual(values=phylumcolors) +
theme_classic()
head(MAGinfo)
Completeness_mean <- aggregate(MAGinfo$Completeness, by=list(MAGinfo$Phylum), FUN=mean)
Completeness_mean
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot() +
scale_fill_manual(values=phylumcolors) +
theme_classic()
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum)) +
geom_boxplot() +
scale_fill_manual(values=phylumcolors) +
theme_classic()
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot() +
scale_fill_manual(values=phylumcolors, alpha=0.7) +
scale_color_manual(values=phylumcolors) +
theme_classic()
phylumcolors <- c("#5b828e","#5e6668","#bbcfd7","#ba9a88","#ac7e62","#aca69f","#adab76","#666b3a","#0f211a","#012e67")
phylumcolorsalpha <- c("#5b828e70","#5e666870","#bbcfd770","#ba9a8870","#ac7e6270","#aca69f70","#adab7670","#666b3a70","#0f211a70","#012e6770")
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot() +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic()
ggplot(MAGinfo,aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot() +
ylim(0, 100) +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic()
View(MAGrel)
ggplot(MAGinfo) +
geom_boxplot(aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
ylim(0, 100) +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic()
ggplot(MAGinfo) +
geom_boxplot(aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot(aes(y=Contamination,x=Phylum,fill=Phylum, color=Phylum)) +
ylim(0, 100) +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic()
ggplot(MAGinfo) +
geom_boxplot(aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot(aes(y=Contamination,x=Phylum,fill=Phylum, color=Phylum)) +
ylim(0, 100) +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic() +
theme(axis.title.y=element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(MAGinfo) +
geom_boxplot(aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot(aes(y=Contamination,x=Phylum,fill=Phylum, color=Phylum)) +
ylim(0, 100) +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic() +
theme(axis.title.y=element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),legend.position = "none")
pdf("figures/MAG_comp-cont_phylum.pdf",width=8,height=4)
ggplot(MAGinfo) +
geom_boxplot(aes(y=Completeness,x=Phylum,fill=Phylum, color=Phylum)) +
geom_boxplot(aes(y=Contamination,x=Phylum,fill=Phylum, color=Phylum)) +
ylim(0, 100) +
scale_fill_manual(values=phylumcolorsalpha) +
scale_color_manual(values=phylumcolors) +
theme_classic() +
theme(axis.title.y=element_blank(), axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),legend.position = "none")
dev.off()
library(ggtree)
library(ggtreeExtra)
MAGtree <- read.tree("data/MAG.tree")
MAGinfo <- read.csv("data/MAG_info.csv")
rownames(MAGinfo) <- MAGinfo[,1]
phylumcolors <- c("#5b828e","#5e6668","#bbcfd7","#ba9a88","#ac7e62","#aca69f","#adab76","#666b3a","#0f211a","#012e67")
base <- ggtree(tree, layout="cladogram", width=0.5) %<+% info +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
phylumcolors <- c("#5b828e","#5e6668","#bbcfd7","#ba9a88","#ac7e62","#aca69f","#adab76","#666b3a","#0f211a","#012e67")
base <- ggtree(MAGtree, layout="cladogram", width=0.5) %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
base <- ggtree(MAGtree, layout="rectangular", width=0.5) %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
ggtree(MAGtree, layout="rectangular" %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
ggtree(MAGtree, layout="rectangular") %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
head(MAGannot)
colnames(MAGannot)
MAGtree <- read.tree("data/MAG.tree")
MAGinfo <- read.csv("data/MAG_info.csv", row.names=1)
MAGannot <- read.delim("data/DRAM_product.tsv",sep='\t', row.names=1)
# Remove MAGs absent in MAG_info
MAGannot <- MAGannot[rownames(MAGinfo),]
# Convert True/False character to 1/0 binary, numeric data
for(i in 1:ncol(MAGannot)){
if(is.character(MAGannot[,i])){
MAGannot[,i][MAGannot[,i]=="True"]=1
MAGannot[,i][MAGannot[,i]=="False"]=0
MAGannot[,i]=as.numeric(MAGannot[,i])
}
}
# Discard completely absent functions from further exploration
colnames(MAGannot[,colSums(MAGannot)==0])
MAGannot <- MAGannot[,colSums(MAGannot)>0]
base <- ggtree(MAGtree, layout="rectangular") %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
gheatmap(base, MAGannot[,c("Complex.I..NADH.quinone.oxidoreductase..prokaryotes","Complex.II..Fumarate.reductase..prokaryotes")], offset = 0, width=.1,
colnames_position="top",
colnames_angle=90, colnames_offset_y = 1,
hjust=0, font.size=2) +
theme(legend.position="none")
base <- ggtree(MAGtree, layout="rectangular") %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
gheatmap(base, MAGannot[,c("Complex.I..NADH.quinone.oxidoreductase..prokaryotes","Complex.II..Fumarate.reductase..prokaryotes")], offset = 0, width=.1,
colnames_position="top",
colnames_angle=90, colnames_offset_y = 1,
hjust=0, font.size=2) +
scale_fill_gradientn(colours = c("#ffffff","#000000")) +
theme(legend.position="none")
base <- ggtree(MAGtree, layout="rectangular") %<+% MAGinfo +
geom_tippoint(aes(color=Phylum))
gheatmap(base, MAGannot[,c("Complex.I..NADH.quinone.oxidoreductase..prokaryotes","Complex.II..Fumarate.reductase..prokaryotes")], offset = 0, width=.1,
colnames_position="top",
colnames_angle=90, colnames_offset_y = 1,
hjust=0, font.size=2) +
scale_color_manual(values=phylumcolors) +
scale_fill_gradientn(colours = c("#ffffff","#000000")) +
theme(legend.position="none")
base <- ggtree(MAGtree, layout="rectangular")
gheatmap(base, MAGannot[,c("Complex.I..NADH.quinone.oxidoreductase..prokaryotes","Complex.II..Fumarate.reductase..prokaryotes")], offset = 0, width=.1,
colnames_position="top",
colnames_angle=90, colnames_offset_y = 1,
hjust=0, font.size=2) +
scale_color_manual(values=phylumcolors) +
scale_fill_gradientn(colours = c("#ffffff","#000000")) +
theme(legend.position="none")
colnames(MAGannot)
base <- ggtree(MAGtree, layout="rectangular") %<+% MAGinfo +
geom_tippoint(aes(color=Phylum)) +
scale_color_manual(values=phylumcolors)
gheatmap(base, MAGannot[,c(13:25)], offset = 0, width=.1,
colnames_position="top",
colnames_angle=90, colnames_offset_y = 1,
hjust=0, font.size=2) +
scale_fill_gradientn(colours = c("#ffffff","#000000")) +
theme(legend.position="none")
